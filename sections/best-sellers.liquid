<section class="section product" id="product" aria-label="product">
    <div class="container">

      <div class="title-wrapper">
        <span class="section-eyebrow">Curated Selection</span>
        <h2 class="h2 section-title">Best Sellers</h2>
        <p class="section-subtitle">Discover our most coveted fragrances, meticulously crafted and beloved by connoisseurs</p>

        <ul class="filter-btn-list" role="tablist">
          <li class="filter-btn-item">
            <button class="filter-btn active" data-filter-btn="all" role="tab" aria-selected="true" aria-controls="all-products">
              <span>All</span>
            </button>
          </li>
          <li class="filter-btn-item">
            <button class="filter-btn" data-filter-btn="men" role="tab" aria-selected="false" aria-controls="men-products">
              <span>Men</span>
            </button>
          </li>
          <li class="filter-btn-item">
            <button class="filter-btn" data-filter-btn="women" role="tab" aria-selected="false" aria-controls="women-products">
              <span>Women</span>
            </button>
          </li>
        </ul>
      </div>

      <div class="products-container">
        <ul class="grid-list product-list" data-filter="all" id="all-products" role="tabpanel">
          {% assign collection_handle = 'best-sellers' %}
          {% for product in collections[collection_handle].products limit: 12 %}
            <li class="decoration product-item {% if product.tags contains 'men' %}men{% elsif product.tags contains 'women' %}women{% endif %}" data-category="{% if product.tags contains 'men' %}men{% elsif product.tags contains 'women' %}women{% else %}all{% endif %}">
              <div class="product-card">
                <a href="{{ product.url }}" class="card-banner img-holder has-before" style="--width: 300; --height: 300;" aria-label="{{ product.title }}">
                  {% if product.featured_image %}
                    <img src="{{ product.featured_image | img_url: 'large' }}" 
                      alt="{{ product.featured_image.alt | escape }}" 
                      class="img-cover" 
                      width="300" 
                      height="300" 
                      loading="lazy">
                  {% else %}
                    <img src="{{ 'default-image.jpg' | asset_url }}" 
                      alt="No image available" 
                      class="img-cover" 
                      width="300" 
                      height="300" 
                      loading="lazy">
                  {% endif %}
                  <div class="overlay" aria-hidden="true"></div>
                  <div class="shine-effect" aria-hidden="true"></div>
                </a>
                
                <ul class="card-action-list">
                  <li>
                    <button class="card-action-btn quick-add" aria-label="Quick view {{ product.title }}" title="Quick view">
                      <ion-icon name="eye-outline" aria-hidden="true"></ion-icon>
                    </button>
                  </li>
                  <li>
                    <form action="/cart/add" method="post" enctype="multipart/form-data" class="add-to-cart-form" onsubmit="submitAddToCartForm(this); return false;">
                      <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
                      <button type="submit" class="card-action-btn add-to-cart" aria-label="Add {{ product.title }} to cart" {% unless product.available %}disabled{% endunless %}>
                        <ion-icon name="bag-handle-outline" aria-hidden="true"></ion-icon>
                        {% if product.available == false %}<span class="visually-hidden">Out of stock</span>{% endif %}
                      </button>
                    </form>
                  </li>
                  <li>
                    <button class="card-action-btn wishlist" aria-label="Add {{ product.title }} to wishlist" title="Add to wishlist">
                      <ion-icon name="heart-outline" aria-hidden="true"></ion-icon>
                    </button>
                  </li>
                </ul>

                <ul class="badge-list">
                  {% if product.available %}
                    {% if product.compare_at_price > product.price %}
                      <li>
                        <div class="badge sale">Sale</div>
                      </li>
                    {% endif %}
                    {% assign discount = 100.0 | times: product.compare_at_price | minus: product.price | divided_by: product.compare_at_price | round: 0 %}
                    {% if discount > 0 %}
                      <li>
                        <div class="badge discount">-{{ discount }}%</div>
                      </li>
                    {% endif %}
                  {% else %}
                    <li>
                      <div class="badge unavailable">Unavailable</div>
                    </li>
                  {% endif %}
                </ul>

                <div class="card-content">
                  <h3 class="h3">
                    <a href="{{ product.url }}" class="card-title">{{ product.title }}</a>
                  </h3>
                  
                  {% if product.available %}
                    <div class="rating" aria-label="Average rating {{ product.metafields.custom.rating | default: 4.5 }}/5">
                      <span class="stars" style="--rating: {{ product.metafields.custom.rating | default: 4.5 | times: 20 }};">★★★★★</span>
                      <span class="review-count">({{ product.metafields.custom.reviews_count | default: 23 }})</span>
                    </div>
                  {% endif %}

                  <div class="card-price">
                    {% if product.compare_at_price > product.price %}
                      <del class="del">{{ product.compare_at_price | money }}</del>
                    {% endif %}
                    <data class="price" value="{{ product.price | divided_by: 100.0 }}">{{ product.price | money }}</data>
                  </div>
                  
                  {% unless product.available %}
                    <span class="stock-status">Currently Unavailable</span>
                  {% endunless %}
                </div>
              </div>
            </li>
          {% endfor %}
          {% unless collections[collection_handle].products.size > 0 %}
            <li class="decoration empty-state">
              <div class="product-card empty-card">
                <div class="empty-content">
                  <ion-icon name="flame-outline" class="empty-icon"></ion-icon>
                  <p>Our best sellers collection is being curated. Please return soon.</p>
                  <a href="/collections/all" class="btn-link">Explore All Fragrances →</a>
                </div>
              </div>
            </li>
          {% endunless %}
        </ul>
      </div>

      {% if collections[collection_handle].products.size > 6 %}
        <div class="load-more-wrapper">
          <button class="btn load-more" id="load-more-btn">
            <span>Discover More</span>
            <ion-icon name="arrow-down-outline"></ion-icon>
          </button>
        </div>
      {% endif %}

    </div>
  </section>

  <style>
    /* Enhanced Section Styling */
    .section-eyebrow {
      display: block;
      text-align: center;
      font-size: var(--fs-8);
      letter-spacing: 0.15em;
      text-transform: uppercase;
      color: var(--primary-600);
      font-weight: 500;
      margin-bottom: 0.5rem;
    }

    .section-title {
      letter-spacing: -0.02em;
      margin-bottom: 1rem;
    }

    .section-subtitle {
      color: var(--gray-600);
      font-size: var(--fs-6);
      text-align: center;
      margin-bottom: 3rem;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
      line-height: 1.6;
      font-weight: 300;
    }

    /* Refined Filter Buttons */
    .filter-btn-list {
      gap: 0.5rem;
      margin-bottom: 3rem;
    }

    .filter-btn {
      position: relative;
      padding: 0.75rem 2rem;
      border: 1px solid var(--gray-300);
      background: transparent;
      color: var(--gray-700);
      font-weight: 500;
      letter-spacing: 0.05em;
      transition: all 0.3s ease;
      overflow: hidden;
    }

    .filter-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: var(--primary-600);
      transition: left 0.3s ease;
      z-index: -1;
    }

    .filter-btn.active {
      background: var(--primary-600);
      border-color: var(--primary-600);
      color: white;
    }

    .filter-btn.active::before {
      left: 0;
    }

    .filter-btn:hover:not(.active) {
      border-color: var(--primary-400);
      color: var(--primary-600);
    }

    .filter-btn span {
      position: relative;
      z-index: 1;
    }

    /* Enhanced Product Card */
    .products-container {
      position: relative;
    }

    .product-item {
      opacity: 1;
      transform: translateY(0);
      transition: opacity 0.4s ease, transform 0.4s ease;
    }

    .product-item.hidden {
      opacity: 0;
      transform: translateY(30px);
      pointer-events: none;
      position: absolute;
    }

    .product-card {
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.06);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
    }

    .product-card:hover {
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.12);
      transform: translateY(-8px);
    }

    /* Image Effects */
    .card-banner {
      position: relative;
      overflow: hidden;
    }

    .card-banner .img-cover {
      transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .product-card:hover .card-banner .img-cover {
      transform: scale(1.08);
    }

    .card-banner .overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(180deg, transparent 0%, rgba(0, 0, 0, 0.3) 100%);
      opacity: 0;
      transition: opacity 0.4s ease;
    }

    .card-banner:hover .overlay {
      opacity: 1;
    }

    .shine-effect {
      position: absolute;
      top: 0;
      left: -100%;
      width: 50%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: skewX(-20deg);
      transition: left 0.6s ease;
    }

    .product-card:hover .shine-effect {
      left: 150%;
    }

    /* Elegant Action Buttons */
    .card-action-list {
      position: absolute;
      bottom: 1rem;
      right: 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      opacity: 0;
      transform: translateX(20px);
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 10;
    }

    .product-card:hover .card-action-list {
      opacity: 1;
      transform: translateX(0);
    }

    .card-action-btn {
      width: 42px;
      height: 42px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(0, 0, 0, 0.05);
      border-radius: 50%;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .card-action-btn:hover {
      transform: scale(1.15);
      background: var(--primary-600);
      color: white;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
    }

    .card-action-btn ion-icon {
      font-size: 1.25rem;
      transition: color 0.3s ease;
    }

    .card-action-btn:hover ion-icon {
      color: white;
    }

    .card-action-btn:disabled {
      opacity: 0.4;
      cursor: not-allowed;
      transform: none;
    }

    .card-action-btn:disabled:hover {
      background: rgba(255, 255, 255, 0.95);
      transform: none;
    }

    /* Sophisticated Badges */
    .badge-list {
      position: absolute;
      top: 1rem;
      left: 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      z-index: 5;
    }

    .badge {
      font-size: var(--fs-9);
      padding: 0.4rem 0.75rem;
      border-radius: 20px;
      font-weight: 600;
      letter-spacing: 0.03em;
      backdrop-filter: blur(10px);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    .badge.sale {
      background: rgba(220, 53, 69, 0.95);
      color: white;
    }

    .badge.discount {
      background: rgba(13, 202, 240, 0.95);
      color: white;
    }

    .badge.unavailable {
      background: rgba(108, 117, 125, 0.9);
      color: white;
    }

    /* Refined Card Content */
    .card-content {
      padding: 1.5rem;
      background: linear-gradient(to bottom, white, rgba(249, 250, 251, 0.5));
    }

    .card-title {
      font-size: var(--fs-5);
      font-weight: 600;
      color: var(--gray-900);
      text-decoration: none;
      letter-spacing: -0.01em;
      line-height: 1.3;
      transition: color 0.3s ease;
      display: block;
      margin-bottom: 0.75rem;
    }

    .card-title:hover {
      color: var(--primary-600);
    }

    /* Elegant Rating Display */
    .rating {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }

    .stars {
      position: relative;
      display: inline-block;
      font-size: 1rem;
      letter-spacing: 0.1em;
      color: #e0e0e0;
    }

    .stars::before {
      content: '★★★★★';
      position: absolute;
      top: 0;
      left: 0;
      color: #ffc107;
      overflow: hidden;
      width: var(--rating, 0%);
    }

    .review-count {
      font-size: var(--fs-9);
      color: var(--gray-500);
      font-weight: 400;
    }

    /* Sophisticated Pricing */
    .card-price {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-size: var(--fs-5);
      margin-top: 0.5rem;
    }

    .card-price .del {
      color: var(--gray-400);
      font-size: var(--fs-6);
      text-decoration: line-through;
      font-weight: 400;
    }

    .card-price .price {
      color: var(--gray-900);
      font-weight: 700;
      letter-spacing: -0.02em;
    }

    .stock-status {
      display: inline-block;
      color: var(--gray-500);
      font-size: var(--fs-9);
      font-style: italic;
      margin-top: 0.5rem;
    }

    /* Empty State */
    .empty-state {
      grid-column: 1 / -1;
    }

    .empty-card {
      text-align: center;
      padding: 5rem 2rem;
      background: linear-gradient(135deg, rgba(249, 250, 251, 0.8), rgba(255, 255, 255, 0.9));
      border: 2px dashed var(--gray-300);
    }

    .empty-icon {
      font-size: 4rem;
      color: var(--gray-300);
      margin-bottom: 1.5rem;
      opacity: 0.5;
    }

    .empty-content p {
      color: var(--gray-600);
      margin-bottom: 1.5rem;
      font-size: var(--fs-6);
    }

    .btn-link {
      color: var(--primary-600);
      text-decoration: none;
      font-weight: 600;
      letter-spacing: 0.02em;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
    }

    .btn-link:hover {
      color: var(--primary-700);
      gap: 0.5rem;
    }

    /* Elegant Load More */
    .load-more-wrapper {
      text-align: center;
      margin-top: 4rem;
    }

    .load-more {
      background: linear-gradient(135deg, var(--primary-600), var(--primary-700));
      color: white;
      border: none;
      padding: 1rem 2.5rem;
      border-radius: 50px;
      cursor: pointer;
      font-weight: 600;
      letter-spacing: 0.05em;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .load-more::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s ease;
    }

    .load-more:hover::before {
      left: 100%;
    }

    .load-more:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 25px rgba(0, 0, 0, 0.2);
    }

    .load-more ion-icon {
      font-size: 1.25rem;
      transition: transform 0.3s ease;
    }

    .load-more:hover ion-icon {
      transform: translateY(3px);
    }

    /* Accessibility */
    .visually-hidden {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .section-subtitle {
        font-size: var(--fs-7);
        padding: 0 1rem;
      }

      .filter-btn-list {
        flex-wrap: wrap;
        justify-content: center;
        gap: 0.5rem;
      }

      .filter-btn {
        padding: 0.6rem 1.5rem;
        font-size: var(--fs-8);
      }

      .grid-list {
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1.5rem;
      }

      .card-action-list {
        opacity: 1;
        transform: translateX(0);
      }

      .load-more {
        padding: 0.875rem 2rem;
      }
    }
  </style>

  <script>
    // Enhanced Filter functionality with smooth transitions
    const filterBtns = document.querySelectorAll('[data-filter-btn]');
    const productItems = document.querySelectorAll('.product-item');
    const tabPanels = document.querySelectorAll('[role="tabpanel"]');

    filterBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        const filterValue = btn.getAttribute('data-filter-btn');

        // Update active button
        filterBtns.forEach(b => {
          b.classList.remove('active');
          b.setAttribute('aria-selected', 'false');
        });
        btn.classList.add('active');
        btn.setAttribute('aria-selected', 'true');

        // Hide all tab panels except current
        tabPanels.forEach(panel => panel.style.display = 'none');
        const currentPanel = document.getElementById(`${filterValue}-products`);
        if (currentPanel) currentPanel.style.display = 'block';

        // Filter products with stagger effect
        productItems.forEach((item, index) => {
          const category = item.getAttribute('data-category');
          if (filterValue === 'all' || category === filterValue) {
            setTimeout(() => {
              item.classList.remove('hidden');
            }, index * 50);
          } else {
            item.classList.add('hidden');
          }
        });
      });
    });

    // Quick view modal
    document.querySelectorAll('.quick-add').forEach(btn => {
      btn.addEventListener('click', (e) => {
        e.preventDefault();
        const productTitle = btn.closest('.product-card').querySelector('.card-title').textContent;
        // Integrate with your modal system here
        console.log(`Quick view for ${productTitle}`);
      });
    });

    // Enhanced Wishlist toggle
    document.querySelectorAll('.wishlist').forEach(btn => {
      btn.addEventListener('click', () => {
        const icon = btn.querySelector('ion-icon');
        const isWishlisted = icon.getAttribute('name') === 'heart';
        icon.setAttribute('name', isWishlisted ? 'heart-outline' : 'heart');
        
        // Add subtle animation
        btn.style.transform = 'scale(1.2)';
        setTimeout(() => {
          btn.style.transform = '';
        }, 200);
      });
    });

    // Load more functionality
    const loadMoreBtn = document.getElementById('load-more-btn');
    if (loadMoreBtn) {
      loadMoreBtn.addEventListener('click', () => {
        // Implement your pagination or infinite scroll logic here
        loadMoreBtn.querySelector('span').textContent = 'Loading...';
        setTimeout(() => {
          loadMoreBtn.querySelector('span').textContent = 'Discover More';
        }, 1000);
      });
    }

    // Enhanced Add to cart feedback
    document.querySelectorAll('.add-to-cart-form').forEach(form => {
      form.addEventListener('submit', (e) => {
        const btn = form.querySelector('button');
        const originalHTML = btn.innerHTML;
        btn.innerHTML = '<ion-icon name="checkmark-outline"></ion-icon><span class="visually-hidden">Added to cart</span>';
        btn.style.background = '#22c55e';
        
        setTimeout(() => {
          btn.innerHTML = originalHTML;
          btn.style.background = '';
        }, 2500);
      });
    });

    // Intersection Observer for scroll animations
    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.style.opacity = '1';
          entry.target.style.transform = 'translateY(0)';
        }
      });
    }, observerOptions);

    productItems.forEach(item => {
      item.style.opacity = '0';
      item.style.transform = 'translateY(30px)';
      observer.observe(item);
    });
  </script>
   
{% schema %}
{
  "name": "Best Sellers",
  "settings": [
    {
      "type": "text",
      "id": "section_eyebrow",
      "label": "Section Eyebrow",
      "default": "Curated Selection"
    },
    {
      "type": "text",
      "id": "section_title",
      "label": "Section Title",
      "default": "Best Sellers"
    },
    {
      "type": "textarea",
      "id": "section_subtitle",
      "label": "Section Subtitle",
      "default": "Discover our most coveted fragrances, meticulously crafted and beloved by connoisseurs"
    }
  ],
  "blocks": [
    {
      "type": "collection_section",
      "name": "Collection Section",
      "settings": [
        {
          "type": "collection",
          "id": "specific_collection",
          "label": "Select Best Sellers Collection",
          "info": "Override the default 'best-sellers' collection here."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Best Sellers"
    }
  ]
}
{% endschema %}